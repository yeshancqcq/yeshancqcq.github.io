labs(y = "数量",
x = "时间（百万年前）",
colour = "图例")+
scale_x_reverse(limits = c(250, 65), breaks = scales::pretty_breaks(n = 20))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 10))
plot3
plot3 <- ggplot()+
geom_line(data=packages,aes(time, dino_count, colour="恐龙化石总数"))+
geom_line(data=packages,aes(time, type, colour="恐龙类别"))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.right = element_blank(),
axis.ticks.x = element_line(color="black", size = 0.2),
axis.line.x = element_line(color="black", size = 0.2),
axis.text.x = element_text(),
axis.line.y.left = element_line(colour="black", size = 0.2),
axis.text.y.right = element_blank(),
legend.justification = c(0, 0),
legend.position = c(0.1,0.5),
legend.key = element_rect(colour = "white", fill = NA),
text = element_text(family = 'Kai')
)+
ggtitle("中国境内恐龙的时间分布")+
labs(y = "数量",
x = "时间（百万年前）",
colour = "图例")+
scale_x_reverse(limits = c(250, 65), breaks = scales::pretty_breaks(n = 20))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 10))
plot3
g3 <- plot3
gp3 <- plot_grid(g1, g3, align = "v", nrow = 2, rel_heights = c(1/8, 1))
gp3
timescale2 <- read_csv("~/Documents/china_dino/timescale2.csv")
library(readr)
data2 <- read_csv("~/Documents/china_dino/data2.csv")
View(data2)
packages2 <- data.frame(time=seq(1, 550, by=1))
packages2$count <- NA
packages2$type <- NA
for(i in 1:nrow(packages2)){
type = 0
count = 0
dict = vector()
for(j in 1:nrow(data2)){
if(data2$max_ma[j]>=packages2$time[i]&&
data2$min_ma[j]<=packages2$time[i]){
if(isFALSE(toString(data2$accepted_name[j]) %in% dict)){
type = type + 1
dict <- c(dict, toString(data2$accepted_name[j]))
}
count <- count +1
}
}
packages2$type[i] <- type
packages2$count[i] <- count
cat("processing", i, "\n")
}
View(packages2)
timescale2$mid = (timescale2$min + timescale2$max)/2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = colors),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timescale2 <- read_csv("~/Documents/china_dino/timescale2.csv")
data2 <- read_csv("~/Documents/china_dino/data2.csv")
timescale2$mid = (timescale2$min + timescale2$max)/2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = colors),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = colors),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = colors),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = color),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = color),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = timescale2$color)+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
rev(
rev(
))
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = color),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
View(timeline2)
View(timescale2)
color <- timescale2$color
color
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = rev(timescale2$color))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = color)+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = c(
"Q"=	"#F9F97F",
"Ng"=	"#FFE619",
"Pg"=	"#FD9A52",
"K"=	"#7FC64E",
"J"=	"#34B2C9",
"Tr"=	"#812B92",
"P"=	"#F04028",
"C"=	"#67A599",
"D"=	"#CB8C37",
"S"=	"#B3E1B6",
"O"=	"#009270",
"Cm"=	"#7FA056",
"E"=	"#FFC3E1"
))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
timescale2 <- read_csv("~/Documents/china_dino/timescale2.csv")
timescale2$mid = (timescale2$min + timescale2$max)/2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = c(
""=	"#F9F97F",
"Ng"=	"#FFE619",
"Pg"=	"#FD9A52",
"K"=	"#7FC64E",
"J"=	"#34B2C9",
"Tr"=	"#812B92",
"P"=	"#F04028",
"C"=	"#67A599",
"D"=	"#CB8C37",
"S"=	"#B3E1B6",
"O"=	"#009270",
"Cm"=	"#7FA056",
"E"=	"#FFC3E1"
))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timescale2 <- read_csv("~/Documents/china_dino/timescale2.csv")
timescale2$mid = (timescale2$min + timescale2$max)/2
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = c(
""=	"#F9F97F",
"Ng"=	"#FFE619",
"Pg"=	"#FD9A52",
"K"=	"#7FC64E",
"J"=	"#34B2C9",
"Tr"=	"#812B92",
"P"=	"#F04028",
"C"=	"#67A599",
"D"=	"#CB8C37",
"S"=	"#B3E1B6",
"O"=	"#009270",
"Cm"=	"#7FA056",
"E"=	"#FFC3E1"
))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2 <- ggplot() +
geom_rect(data=timescale2, mapping=aes(xmin=min, xmax=max, ymin=0, ymax=1, fill = mark),color="black",size=0.2) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.left = element_blank(),
axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.line= element_blank(),
axis.text.y.left = element_blank(),
legend.position = "none",
legend.key = element_rect(colour = "white", fill = NA)
)+
annotate("text",
y=c(0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5),
x=rev(timescale2$mid),
label=rev(timescale2$mark),
size=3.5,
#color="white",
family="Kai")+
scale_fill_manual(values = c(
" "=	"#F9F97F",
"Ng"=	"#FFE619",
"Pg"=	"#FD9A52",
"K"=	"#7FC64E",
"J"=	"#34B2C9",
"Tr"=	"#812B92",
"P"=	"#F04028",
"C"=	"#67A599",
"D"=	"#CB8C37",
"S"=	"#B3E1B6",
"O"=	"#009270",
"Cm"=	"#7FA056",
"E"=	"#FFC3E1"
))+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
labs(y = "",
x = "")
timeline2
plot4 <- ggplot()+
geom_line(data=packagess,aes(time, count, colour="古生物化石总数"))+
geom_line(data=packagess,aes(time, type, colour="古生物类别"))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.right = element_blank(),
axis.ticks.x = element_line(color="black", size = 0.2),
axis.line.x = element_line(color="black", size = 0.2),
axis.text.x = element_text(),
axis.line.y.left = element_line(colour="black", size = 0.2),
axis.text.y.right = element_blank(),
legend.justification = c(0, 0),
legend.position = c(0.1,0.5),
legend.key = element_rect(colour = "white", fill = NA),
text = element_text(family = 'Kai')
)+
ggtitle("中国境内恐龙的时间分布")+
labs(y = "数量",
x = "时间（百万年前）",
colour = "图例")+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 10))
plot4 <- ggplot()+
geom_line(data=packages2,aes(time, count, colour="古生物化石总数"))+
geom_line(data=packages2,aes(time, type, colour="古生物类别"))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.right = element_blank(),
axis.ticks.x = element_line(color="black", size = 0.2),
axis.line.x = element_line(color="black", size = 0.2),
axis.text.x = element_text(),
axis.line.y.left = element_line(colour="black", size = 0.2),
axis.text.y.right = element_blank(),
legend.justification = c(0, 0),
legend.position = c(0.1,0.5),
legend.key = element_rect(colour = "white", fill = NA),
text = element_text(family = 'Kai')
)+
ggtitle("中国境内恐龙的时间分布")+
labs(y = "数量",
x = "时间（百万年前）",
colour = "图例")+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 10))
plot4
g4 <- plot4
t2 <- timeline2
gp4 <- plot_grid(t2, g4, align = "v", nrow = 2, rel_heights = c(1/8, 1))
gp4
plot4 <- ggplot()+
geom_line(data=packages2,aes(time, count, colour="古生物化石总数"))+
geom_line(data=packages2,aes(time, type, colour="古生物类别"))+
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.ticks.y.right = element_blank(),
axis.ticks.x = element_line(color="black", size = 0.2),
axis.line.x = element_line(color="black", size = 0.2),
axis.text.x = element_text(),
axis.line.y.left = element_line(colour="black", size = 0.2),
axis.text.y.right = element_blank(),
legend.justification = c(0, 0),
legend.position = c(0.1,0.5),
legend.key = element_rect(colour = "white", fill = NA),
text = element_text(family = 'Kai')
)+
ggtitle("中国境内古生物的时间分布")+
labs(y = "数量",
x = "时间（百万年前）",
colour = "图例")+
scale_x_reverse(limits = c(550, 1), breaks = scales::pretty_breaks(n = 20))+
scale_y_continuous(breaks = scales::pretty_breaks(n = 10))
plot4
g4 <- plot4
gp4 <- plot_grid(t2, g4, align = "v", nrow = 2, rel_heights = c(1/8, 1))
gp4
